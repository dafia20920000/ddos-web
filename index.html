<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download PDF dan Kirim Info ke Server</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f7f7f7;
        }
        h1 {
            color: #333;
        }
        .btn-download {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
        }
        .btn-download:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Download PDF dan Kirim Info ke Server</h1>
    <button class="btn-download" onclick="downloadPDF()">Download PDF</button>

    <script>
        // Fungsi untuk mendapatkan informasi perangkat
        async function fetchDeviceInfo() {
            let ip = await fetch('https://api64.ipify.org?format=json').then(res => res.json()).then(data => data.ip);
            let userAgent = navigator.userAgent;
            let os = "Tidak Diketahui";
            let model = "Tidak Diketahui";
            
            if (userAgent.includes("Windows")) os = "Windows";
            else if (userAgent.includes("Mac")) os = "MacOS";
            else if (userAgent.includes("Linux")) os = "Linux";
            else if (/Android/.test(userAgent)) os = "Android " + userAgent.match(/Android (\d+\.\d+)/)[1]; // Versi Android
            else if (/iPhone|iPad|iPod/.test(userAgent)) os = "iOS " + userAgent.match(/OS (\d+_\d+)/)[1].replace('_', '.');
            
            if (/Android/.test(userAgent)) model = userAgent.match(/Android.*; (.*?) Build/)[1] || "Model tidak diketahui";
            else if (/iPhone|iPad|iPod/.test(userAgent)) model = "Apple " + userAgent.match(/iPhone|iPad|iPod (.*) like/)[1];
            
            return { ip, os, model };
        }

        // Fungsi untuk membuat dan mendownload PDF
        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            let doc = new jsPDF();
            const deviceInfo = await fetchDeviceInfo();

            // Menambahkan konten ke PDF
            doc.text("Ini adalah file yang tidak dapat dibuka", 10, 10);
            doc.text("Tapi jika dibuka, informasi perangkat akan dikirim ke server.", 10, 20);
            
            // Link untuk mengirim data ke server saat file dibuka
            let serverLink = `https://yourserver.com/submit_info?device=${encodeURIComponent(deviceInfo.model)}&ip=${encodeURIComponent(deviceInfo.ip)}`;
            doc.text("Klik atau buka file ini untuk mengirimkan data ke server: " + serverLink, 10, 30);
            
            // Menyimpan PDF
            doc.save("error_file.pdf");
        }
    </script>
</body>
</html>
